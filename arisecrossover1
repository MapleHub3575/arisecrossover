local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()
local Window = Rayfield:CreateWindow({
    Name = "Maple Hub",
    LoadingTitle = "Maple Hub Loading...",
    LoadingSubtitle = "by Piphoppat",
    ConfigurationSaving = {
        Enabled = true,                -- âœ… à¹€à¸›à¸´à¸”à¸£à¸°à¸šà¸šà¹€à¸‹à¸Ÿ
        FolderName = "MapleHub",       -- ðŸ“‚ à¸Šà¸·à¹ˆà¸­à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œà¸¢à¹ˆà¸­à¸¢
        FileName = "MapleConfig"       -- ðŸ“„ à¸Šà¸·à¹ˆà¸­à¹„à¸Ÿà¸¥à¹Œ config
    },
    Discord = {
        Enabled = false,
        Invite = "",
        RememberJoins = false
    },
    KeySystem = false
})

local INFOSTab = Window:CreateTab("INFOS", 4483362458)
local INFOSSection = INFOSTab:CreateSection("INFOS Settings")

local SavedPosition -- à¹€à¸à¹‡à¸šà¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¸œà¸¹à¹‰à¹€à¸¥à¹ˆà¸™

INFOSTab:CreateButton({
Name = "Save Position",
    Callback = function()
        local player = game.Players.LocalPlayer
      local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

-- ðŸ” à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œà¸¨à¸±à¸•à¸£à¸¹
local enemiesFolder = workspace:WaitForChild("__Main"):WaitForChild("__Enemies"):WaitForChild("Server")

-- âš™ï¸ à¸•à¸±à¸§à¹à¸›à¸£à¸«à¸¥à¸±à¸
local AutoFarmEnabled = false
local farmSpeed = 5
local currentTween

--------------------------------------------------------
-- ðŸ§­ à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸Šà¹ˆà¸§à¸¢à¸žà¸·à¹‰à¸™à¸à¸²à¸™
--------------------------------------------------------

-- ðŸ”¹ à¸”à¸¶à¸‡ HumanoidRootPart à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢ (à¸à¸±à¸™ Nil)
local function getHRP()
	local char = player.Character or player.CharacterAdded:Wait()
	return char:FindFirstChild("HumanoidRootPart")
end

-- ðŸ”Ž à¸«à¸² Part à¸¨à¸±à¸•à¸£à¸¹à¸—à¸µà¹ˆà¹ƒà¸à¸¥à¹‰à¸•à¸±à¸§à¸—à¸µà¹ˆà¸ªà¸¸à¸” (HP > 0)
local function getClosestEnemyPart()
	local closestPart
	local shortestDistance = math.huge

	for _, part in ipairs(enemiesFolder:GetChildren()) do
		if part:IsA("Part") and part:IsDescendantOf(workspace) then
			local hp = part:GetAttribute("HP")
			if hp and hp > 0 then
				local hrp = getHRP()
				if hrp then
					local distance = (part.Position - hrp.Position).Magnitude
					if distance < shortestDistance then
						shortestDistance = distance
						closestPart = part
					end
				end
			end
		end
	end

	return closestPart
end

-- ðŸ§© à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸§à¸²à¸£à¹Œà¸›à¹„à¸›à¸¨à¸±à¸•à¸£à¸¹ (à¸¡à¸µà¸£à¸°à¸šà¸šà¸à¸±à¸™à¸•à¸à¹‚à¸¥à¸)
local function teleportToEnemyPart(enemyPart, offsetDistance)
	local hrp = getHRP()
	if not (enemyPart and hrp and enemyPart:IsDescendantOf(workspace)) then return end

	local direction = (enemyPart.Position - hrp.Position).Unit
	local distance = (enemyPart.Position - hrp.Position).Magnitude
	local targetPos = enemyPart.Position - direction * offsetDistance

	-- ðŸ’¡ à¸–à¹‰à¸²à¹„à¸à¸¥à¹€à¸à¸´à¸™ 300 stud à¹ƒà¸«à¹‰à¹€à¸—à¹€à¸¥à¸žà¸­à¸£à¹Œà¸•à¸—à¸±à¸™à¸—à¸µ
	if distance > 300 or hrp.Position.Y < -10 then
		hrp.CFrame = CFrame.new(targetPos + Vector3.new(0, 5, 0))
		return
	end

	-- ðŸŒ€ Tween à¸‚à¸¢à¸±à¸šà¹€à¸‚à¹‰à¸²à¹ƒà¸à¸¥à¹‰
	if currentTween then currentTween:Cancel() end
	local tweenTime = math.clamp(distance / (farmSpeed * 100), 0.1, 1)
	local tweenInfo = TweenInfo.new(tweenTime, Enum.EasingStyle.Linear)
	currentTween = TweenService:Create(hrp, tweenInfo, {CFrame = CFrame.new(targetPos)})
	currentTween:Play()
	task.wait(tweenTime)
end

--------------------------------------------------------
-- âš”ï¸ à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸«à¸¥à¸±à¸ Auto Farm
--------------------------------------------------------

local function autoFarm()
	while AutoFarmEnabled do
		local hrp = getHRP()
		if not hrp then
			task.wait(1)
			continue
		end

		local enemyPart = getClosestEnemyPart()
		if enemyPart then
			teleportToEnemyPart(enemyPart, 5)

			-- ðŸ” à¸•à¸µà¸ˆà¸™à¸¨à¸±à¸•à¸£à¸¹à¸•à¸²à¸¢
			while AutoFarmEnabled do
				if not (enemyPart and enemyPart.Parent) then break end
				local hp = enemyPart:GetAttribute("HP")
				if not hp or hp <= 0 then
					task.wait(0.2)
					break
				end
				task.wait(0.05)
			end
		else
			task.wait(0.5)
		end
		task.wait(0.05)
	end
end

--------------------------------------------------------
-- â™»ï¸ à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¹€à¸£à¸´à¹ˆà¸¡à¸«à¸¥à¸±à¸‡à¸£à¸µà¹€à¸à¸´à¸”
--------------------------------------------------------

local function safeStartAutoFarm()
	task.defer(function()
		while true do
			if AutoFarmEnabled then
				local hrp = getHRP()
				if hrp then
					task.spawn(autoFarm)
					break
				end
			end
			task.wait(1)
		end
	end)
end

player.CharacterAdded:Connect(function(newChar)
	task.wait(1)
	character = newChar
	humanoidRootPart = newChar:WaitForChild("HumanoidRootPart")

	if AutoFarmEnabled then
		task.wait(0.5)
		safeStartAutoFarm()
	end
end)

--------------------------------------------------------
-- ðŸŽ›ï¸ UI Controls
--------------------------------------------------------

DungeontTab:CreateToggle({
	Name = "Auto Farm",
	CurrentValue = false,
	Flag = "AutoFarm",
	Callback = function(Value)
		AutoFarmEnabled = Value
		if Value then
			local hrp = getHRP()
			if hrp then
				local firstEnemy = getClosestEnemyPart()
				if firstEnemy then
					hrp.CFrame = CFrame.new(firstEnemy.Position + Vector3.new(0, 5, 0))
				end
			end
			task.spawn(autoFarm)
		else
			if currentTween then
				currentTween:Cancel()
				currentTween = nil
			end
		end
	end,
})

DungeontTab:CreateSlider({
	Name = "Farm Speed",
	Range = {1, 10},
	Increment = 1,
	CurrentValue = farmSpeed,
	Flag = "FarmSpeed",
	Callback = function(Value)
		farmSpeed = Value
	end,
})  if player and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            SavedPosition = player.Character.HumanoidRootPart.Position
            print("Position Saved:", SavedPosition)
            else
            print("Cannot save position, character not found")
        end
    end,
})

INFOSTab:CreateButton({
    Name = "Teleport to Save Position",
    Callback = function()
        local player = game.Players.LocalPlayer
        if SavedPosition and player and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            player.Character.HumanoidRootPart.CFrame = CFrame.new(SavedPosition)
            print("Teleported to saved position")
            else
            print("No saved position or character not found")
        end
    end,
})

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer
local BridgeEvent = ReplicatedStorage:WaitForChild("BridgeNet2"):WaitForChild("dataRemoteEvent")

local SellpetSection = INFOSTab:CreateSection("Auto Sell Settings")

local AutoSellEnabled = false
local connection -- à¹„à¸§à¹‰à¹€à¸à¹‡à¸š event à¹€à¸žà¸·à¹ˆà¸­à¸«à¸¢à¸¸à¸”à¸•à¸­à¸™à¸›à¸´à¸”à¸£à¸°à¸šà¸š

INFOSTab:CreateToggle({
    Name = "Auto Sell (Rank E-UGM+)",
    CurrentValue = false,
    Flag = "AutoSell",
    Callback = function(Value)
        AutoSellEnabled = Value

        if AutoSellEnabled then
            -- à¸«à¸²à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œ Pets
            local petsFolder = player:FindFirstChild("leaderstats")
            if petsFolder then
                petsFolder = petsFolder:FindFirstChild("Inventory")
                if petsFolder then
                    petsFolder = petsFolder:FindFirstChild("Pets")
                end
            end

            if not petsFolder then
                return
            end

            -- à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸‚à¸²à¸¢ pet à¸—à¸µà¹ˆ rank 1â€“10
            local function sellLowRankPets(pet)
                if not AutoSellEnabled then return end
                if pet and pet:IsA("Folder") then
                    local rankValue = pet:GetAttribute("Rank")
                    if typeof(rankValue) == "number" and rankValue >= 1 and rankValue <= 16 then
                        local args = {
                            [1] = {
                                [1] = {
                                    ["Event"] = "SellPet",
                                    ["Pets"] = { pet.Name }
                                },
                                [2] = "\7"
                            }
                        }
                        BridgeEvent:FireServer(unpack(args))
                    end
                end
            end

            -- à¸‚à¸²à¸¢ pet à¸—à¸µà¹ˆà¸¡à¸µà¸­à¸¢à¸¹à¹ˆà¹à¸¥à¹‰à¸§ (à¸–à¹‰à¸²à¸¡à¸µ)
            for _, pet in ipairs(petsFolder:GetChildren()) do
                sellLowRankPets(pet)
            end

            -- à¸•à¸£à¸§à¸ˆà¸—à¸¸à¸à¸„à¸£à¸±à¹‰à¸‡à¸—à¸µà¹ˆà¸¡à¸µ pet à¹ƒà¸«à¸¡à¹ˆà¹€à¸žà¸´à¹ˆà¸¡à¹€à¸‚à¹‰à¸²à¸¡à¸²
            connection = petsFolder.ChildAdded:Connect(function(pet)
                sellLowRankPets(pet)
            end)

        else
            -- à¸›à¸´à¸”à¸£à¸°à¸šà¸š auto sell
            if connection then
                connection:Disconnect()
                connection = nil
            end
        end
    end,
})

local MainTab = Window:CreateTab("Main", 4483362458) -- à¸Šà¸·à¹ˆà¸­ tab + à¹„à¸­à¸„à¸­à¸™
local MainSection = MainTab:CreateSection("Farming Settings")

MainTab:CreateDropdown({
    Name = "Select World",
    Options = {"SoloWorld", "NarutoWorld", "OPWorld", "BleachWorld", "BCWorld", "ChainsawWorld", "JojoWorld", "DBWorld", "OPMWorld", "DanWorld", "Solo2World"},
    CurrentOption = {"SoloWorld"},
    Flag = "SelectedIsland",
    Callback = function(Option)
        print("Selected: " .. Option[1])
    end,
})

MainTab:CreateDropdown({
    Name = "Select Enemies",
    Options = {"Enemies 1", "Enemies 2", "Enemies 3"},
    CurrentOption = {"Enemies 1"},
    Flag = "SelectedEnemies",
    Callback = function(Option)
        print("Selected: " .. Option[1])
    end,
})

MainTab:CreateDropdown({
    Name = "Enemies Type",
    Options = {"Normal", "Big"},
    CurrentOption = {"Normal"},
    Flag = "SelectedType",
    Callback = function(Option)
        print("Selected: " .. Option[1])
    end,
})

MainTab:CreateDropdown({
    Name = "Move Mode",
    Options = {"Slow", "Fast"},
    CurrentOption = {"Slow"},
    Flag = "SelectedType",
    Callback = function(Option)
        print("Selected: " .. Option[1])
    end,
})

MainTab:CreateSlider({
    Name = "Tween Speed",
    Range = {100, 1000},
    Increment = 1,
    Suffix = "",
    CurrentValue = 100,
    Flag = "Tween Speed",
    Callback = function(Value)
        print("Speed = " .. Value)
    end,
})

MainTab:CreateSlider({
    Name = "Farm Delay",
    Range = {0, 5},
    Increment = 0.1,
    Suffix = "",
    CurrentValue = 0.1,
    Flag = "Farm Delay",
    Callback = function(Value)
        print("Speed = " .. Value)
    end,
})

MainTab:CreateToggle({
    Name = "Auto Farm",
    CurrentValue = false,
    Flag = "AutoFarm",
    Callback = function(Value)
        if Value then
            print("Auto Farm On")
        else
            print("Auto Farm Off")
        end
    end,
})

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local event = ReplicatedStorage:WaitForChild("BridgeNet2"):WaitForChild("dataRemoteEvent")

local clickDelay = 0.1
local autoClickEnabled = false

local function autoClick()
    while autoClickEnabled do
        local args = {
            [1] = {
                [1] = {
                    ["Event"] = "PunchAttack"
                },
                [2] = "\5"
            }
        }

        event:FireServer(unpack(args))
        task.wait(clickDelay)
    end
end

MainTab:CreateSlider({
    Name = "Auto Click Delay",
    Range = {0, 1},
    Increment = 0.1,
    Suffix = " sec",
    CurrentValue = clickDelay,
    Callback = function(Value)
        clickDelay = Value
    end,
})

MainTab:CreateToggle({
    Name = "Auto Click (PunchAttack)",
    CurrentValue = false,
    Callback = function(Value)
        autoClickEnabled = Value
        if Value then
            task.spawn(autoClick)
        end
    end,
})


local TeleportTab = Window:CreateTab("Teleport", 4483362458)

--------------------------------------------------
-- ðŸŒ´ EVENT WORLD 1
--------------------------------------------------
local TeleportSection1 = TeleportTab:CreateSection("TeleportEvent World 1")

local EventWorld1Positions = {
    {Name = "Jeju Island", Position = Vector3.new(4016.08643, 48.6075211, 3350.37573)},
    {Name = "Halloween Island", Position = Vector3.new(-295.354584, 20.6939487, -1739.28699)},
}

for _, world in ipairs(EventWorld1Positions) do
    TeleportTab:CreateButton({
        Name = world.Name,
        Callback = function()
            local player = game.Players.LocalPlayer
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                player.Character.HumanoidRootPart.CFrame = CFrame.new(world.Position)
            end
        end
    })
end

--------------------------------------------------
-- ðŸŽƒ EVENT WORLD 2
--------------------------------------------------
local TeleportSection2 = TeleportTab:CreateSection("TeleportEvent World 2")

local EventWorld2Positions = {
    {Name = "Halloween Island", Position = Vector3.new(-367.087646484375, 40.386661529541016, -1956.859619140625)},
}

for _, world in ipairs(EventWorld2Positions) do
    TeleportTab:CreateButton({
        Name = world.Name,
        Callback = function()
            local player = game.Players.LocalPlayer
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                player.Character.HumanoidRootPart.CFrame = CFrame.new(world.Position)
            end
        end
    })
end

--------------------------------------------------
-- ðŸŒŽ WORLD 1
--------------------------------------------------
local TeleportSection3 = TeleportTab:CreateSection("World 1")

local World1Positions = {
    {Name = "SoloWorld", Position = Vector3.new(452.069458, 15.2470932, -22.7720184)},
    {Name = "Grass Village", Position = Vector3.new(-3372.71191, 30.0344715, 2252.61719)},
    {Name = "Brum Lsland", Position = Vector3.new(-2844.155517578125, 50.02361297607422, -2016.807373046875)},
    {Name = "Faceheal Town", Position = Vector3.new(2815.10229, 8.5139246, -2734.53516)},
    {Name = "Lucky Kingdom", Position = Vector3.new(196.180267, 40.2076797, 4297.66455)},
    {Name = "Nipon City", Position = Vector3.new(192.605652, 15.2705383, -4293.87109)},
    {Name = "Mori Town", Position = Vector3.new(4817.64258, 20.8282547, -158.618042)},
    {Name = "Dragon City", Position = Vector3.new(-2561.15479, 30.2231064, 5871.14941)},
    {Name = "XZ City", Position = Vector3.new(3321.18042, 20.2300873, 6384.54492)},
    {Name = "Kindama City", Position = Vector3.new(-3383.6604, 25.4620323, -84.0994873)},
}

for _, world in ipairs(World1Positions) do
    TeleportTab:CreateButton({
        Name = world.Name,
        Callback = function()
            local player = game.Players.LocalPlayer
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                player.Character.HumanoidRootPart.CFrame = CFrame.new(world.Position)
            end
        end
    })
end

--------------------------------------------------
-- ðŸŒ WORLD 2
--------------------------------------------------
local TeleportSection4 = TeleportTab:CreateSection("World 2")

local World2Positions = {
    {Name = "Hunters City", Position = Vector3.new(-241.06199645996094, 15.942999839782715, -13.78600025177002)},
    {Name = "Nen City", Position = Vector3.new(-5225.88671875, 35.88656234741211, -2923.06201171875)},
    {Name = "Hurricane", Position = Vector3.new(-1289.09521484375, 47.42665481567383, -5173.0888671875)},
    {Name = "Cursed High", Position = Vector3.new(735.7350463867188, 58.68924331665039, 5018.86083984375)},
    {Name = "Slayer's Village", Position = Vector3.new(-6852.6513671875, 80.42222595214844, 1596.4384765625)},
    {Name = "Kaiju City", Position = Vector3.new(5119.162109375, 101.46529388427734, 36.499000549316406)},
    {Name = "Wall Kingdom", Position = Vector3.new(-9007.994140625, 85.90940856933594, -1793.15625)},
    {Name = "Shield Kingdom", Position = Vector3.new(-4769.32373046875, 91.6708984375, -8029.35986328125)},
    {Name = "Ghoul City", Position = Vector3.new(2589.732177734375, 91.97673797607422, -4194.45068359375)},
    {Name = "Eminance Kingdom", Position = Vector3.new(-4194.46240234375, 120.6724624633789, 4690.453125)},
    {Name = "Monach City", Position = Vector3.new(3715.7470703125, 128.0664520263672, 3817.377685546875)},
}

for _, world in ipairs(World2Positions) do
    TeleportTab:CreateButton({
        Name = world.Name,
        Callback = function()
            local player = game.Players.LocalPlayer
            if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                player.Character.HumanoidRootPart.CFrame = CFrame.new(world.Position)
            end
        end
    })
end


local DungeontTab = Window:CreateTab("Dungeont", 4483362458)
local DungeontSection = DungeontTab:CreateSection("Dungeont Settings")

------------------------------------------------------
-- ðŸŒ¸ Auto Dungeont (Teleport when Dungeon appears)
------------------------------------------------------

local Players = game:GetService("Players")
local player = Players.LocalPlayer

local function startAutoDungeon()
	task.spawn(function()
		local dungeonFolder = workspace:WaitForChild("__Main"):WaitForChild("__Dungeon")

		while AutoDungeontToggle.CurrentValue do
			local character = player.Character or player.CharacterAdded:Wait()
			local hrp = character:WaitForChild("HumanoidRootPart")

			-- à¸•à¸£à¸§à¸ˆà¸§à¹ˆà¸²à¸¡à¸µ Dungeon à¸­à¸¢à¸¹à¹ˆà¹à¸¥à¹‰à¸§à¹„à¸«à¸¡
			local dungeonPart = dungeonFolder:FindFirstChild("Dungeon")
			if dungeonPart then
				-- à¸§à¸²à¸›à¹„à¸›à¸«à¸²à¹€à¸¥à¸¢
				hrp.CFrame = dungeonPart.CFrame * CFrame.new(0, 5, 0)
				return
			end

			-- à¸–à¹‰à¸²à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µ à¹ƒà¸«à¹‰à¸£à¸­à¸ˆà¸™à¸–à¸¹à¸à¸ªà¸£à¹‰à¸²à¸‡
			local newPart = dungeonFolder.ChildAdded:Wait()
			if newPart.Name == "Dungeon" and AutoDungeontToggle.CurrentValue then
				local character = player.Character or player.CharacterAdded:Wait()
				local hrp = character:WaitForChild("HumanoidRootPart")
				hrp.CFrame = newPart.CFrame * CFrame.new(0, 5, 0)
				return
			end
		end
	end)
end

------------------------------------------------------
-- ðŸŒ¸ Toggle UI
------------------------------------------------------
AutoDungeontToggle = DungeontTab:CreateToggle({
	Name = "Auto Dungeont",
	CurrentValue = false,
	Flag = "AutoDungeont",
	Callback = function(Value)
		if Value then
			startAutoDungeon()
		end
	end,
})

-- ðŸŒ€ AUTO FARM DUNGEON (Full Version by Maple)
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

-- ðŸ” à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œà¸¨à¸±à¸•à¸£à¸¹
local enemiesFolder = workspace:WaitForChild("__Main"):WaitForChild("__Enemies"):WaitForChild("Server")

-- âš™ï¸ à¸•à¸±à¸§à¹à¸›à¸£à¸«à¸¥à¸±à¸
local AutoFarmEnabled = false
local farmSpeed = 5
local teleportDistance = 5 -- à¸£à¸°à¸¢à¸°à¸«à¹ˆà¸²à¸‡à¸ˆà¸²à¸à¸¨à¸±à¸•à¸£à¸¹ (studs)
local currentTween

--------------------------------------------------------
-- ðŸ§­ à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸Šà¹ˆà¸§à¸¢à¸žà¸·à¹‰à¸™à¸à¸²à¸™
--------------------------------------------------------

-- ðŸ”¹ à¸”à¸¶à¸‡ HumanoidRootPart à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢
local function getHRP()
	local char = player.Character or player.CharacterAdded:Wait()
	return char:FindFirstChild("HumanoidRootPart")
end

-- ðŸ”Ž à¸«à¸² Part à¸¨à¸±à¸•à¸£à¸¹à¸—à¸µà¹ˆà¹ƒà¸à¸¥à¹‰à¸•à¸±à¸§à¸—à¸µà¹ˆà¸ªà¸¸à¸” (HP > 0)
local function getClosestEnemyPart()
	local closestPart
	local shortestDistance = math.huge

	for _, part in ipairs(enemiesFolder:GetChildren()) do
		if part:IsA("Part") and part:IsDescendantOf(workspace) then
			local hp = part:GetAttribute("HP")
			if hp and hp > 0 then
				local hrp = getHRP()
				if hrp then
					local distance = (part.Position - hrp.Position).Magnitude
					if distance < shortestDistance then
						shortestDistance = distance
						closestPart = part
					end
				end
			end
		end
	end

	return closestPart
end

--------------------------------------------------------
-- ðŸ§© à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸§à¸²à¸£à¹Œà¸›à¹„à¸›à¸¨à¸±à¸•à¸£à¸¹ (XZ Offset + à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¸•à¸à¹‚à¸¥à¸)
-- ðŸ§© à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸§à¸²à¸£à¹Œà¸›à¹„à¸›à¸¨à¸±à¸•à¸£à¸¹ (XZ Offset + à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¸•à¸à¹‚à¸¥à¸ + à¸«à¸²à¸žà¸·à¹‰à¸™)
local function teleportToEnemyPart(enemyPart, offsetDistance)
	local hrp = getHRP()
	if not (enemyPart and hrp and enemyPart:IsDescendantOf(workspace)) then return false end

	local direction = (enemyPart.Position - hrp.Position).Unit
	local distance = (enemyPart.Position - hrp.Position).Magnitude

	-- à¸ˆà¸¸à¸”à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢à¹à¸™à¸§à¸™à¸­à¸™ XZ (à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¹ƒà¸ªà¹ˆ Y)
	local targetXZ = enemyPart.Position - Vector3.new(direction.X, 0, direction.Z) * offsetDistance

	-- ðŸ”Ž Raycast à¸«à¸²à¸žà¸·à¹‰à¸™à¹ƒà¸•à¹‰à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¹€à¸›à¹‰à¸²à¸«à¸¡à¸²à¸¢
	local rayOrigin = Vector3.new(targetXZ.X, enemyPart.Position.Y + 10, targetXZ.Z)
	local rayDirection = Vector3.new(0, -100, 0)
	local raycastParams = RaycastParams.new()
	raycastParams.FilterDescendantsInstances = {enemyPart}
	raycastParams.FilterType = Enum.RaycastFilterType.Exclude

	local result = workspace:Raycast(rayOrigin, rayDirection, raycastParams)
	local groundY = result and result.Position.Y or enemyPart.Position.Y

	-- à¹€à¸žà¸´à¹ˆà¸¡à¸„à¸§à¸²à¸¡à¸ªà¸¹à¸‡à¸­à¸µà¸à¸™à¸´à¸”à¸à¸±à¸™à¸ˆà¸¡à¸žà¸·à¹‰à¸™
	local targetPos = Vector3.new(targetXZ.X, groundY + 3, targetXZ.Z)

	-- à¸–à¹‰à¸²à¹„à¸à¸¥à¹€à¸à¸´à¸™à¸«à¸£à¸·à¸­ Y < -10 â†’ à¸§à¸²à¸£à¹Œà¸›à¸—à¸±à¸™à¸—à¸µ
	if distance > 500 or hrp.Position.Y < -10 then
		hrp.CFrame = CFrame.new(targetPos)
		return false
	end

	-- Tween à¹€à¸„à¸¥à¸·à¹ˆà¸­à¸™à¸—à¸µà¹ˆà¸™à¸¸à¹ˆà¸¡à¸™à¸§à¸¥
	if currentTween then currentTween:Cancel() end
	local tweenTime = math.clamp(distance / (farmSpeed * 100), 0.1, 1)
	local tweenInfo = TweenInfo.new(tweenTime, Enum.EasingStyle.Linear)
	currentTween = TweenService:Create(hrp, tweenInfo, {CFrame = CFrame.new(targetPos)})
	currentTween:Play()
	task.wait(tweenTime)

	return true
end
--------------------------------------------------------
-- âš”ï¸ à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸«à¸¥à¸±à¸ Auto Farm
--------------------------------------------------------
local function autoFarm()
	while AutoFarmEnabled do
		local hrp = getHRP()
		if not hrp then
			task.wait(1)
			continue
		end

		local enemyPart = getClosestEnemyPart()
		if enemyPart then
			local success = teleportToEnemyPart(enemyPart, teleportDistance)

			-- âŒ à¸–à¹‰à¸²à¸•à¸à¹‚à¸¥à¸à¸«à¸£à¸·à¸­à¸§à¸²à¸£à¹Œà¸›à¸à¸¥à¸±à¸š (return false) â†’ à¸‚à¹‰à¸²à¸¡ loop à¸™à¸µà¹‰à¸—à¸±à¸™à¸—à¸µ
			if not success then
				task.wait(0.5)
				continue
			end

			-- ðŸ” à¸•à¸µà¸ˆà¸™à¸¨à¸±à¸•à¸£à¸¹à¸•à¸²à¸¢
			while AutoFarmEnabled do
				if not (enemyPart and enemyPart.Parent) then break end
				local hp = enemyPart:GetAttribute("HP")
				if not hp or hp <= 0 then
					task.wait(0.2)
					break
				end
				task.wait(0.05)
			end
		else
			task.wait(0.5)
		end
		task.wait(0.05)
	end
end
--------------------------------------------------------
-- â™»ï¸ à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¹€à¸£à¸´à¹ˆà¸¡à¸«à¸¥à¸±à¸‡à¸£à¸µà¹€à¸à¸´à¸”
--------------------------------------------------------
local function safeStartAutoFarm()
	task.defer(function()
		while true do
			if AutoFarmEnabled then
				local hrp = getHRP()
				if hrp then
					task.spawn(autoFarm)
					break
				end
			end
			task.wait(1)
		end
	end)
end

player.CharacterAdded:Connect(function(newChar)
	task.wait(1)
	character = newChar
	humanoidRootPart = newChar:WaitForChild("HumanoidRootPart")

	if AutoFarmEnabled then
		task.wait(0.5)
		safeStartAutoFarm()
	end
end)

--------------------------------------------------------
-- ðŸŽ›ï¸ UI Controls
--------------------------------------------------------
DungeontTab:CreateToggle({
	Name = "Auto Farm",
	CurrentValue = false,
	Flag = "AutoFarm",
	Callback = function(Value)
		AutoFarmEnabled = Value
		if Value then
			local hrp = getHRP()
			if hrp then
				local firstEnemy = getClosestEnemyPart()
				if firstEnemy then
					-- à¸§à¸²à¸£à¹Œà¸›à¹„à¸›à¸¨à¸±à¸•à¸£à¸¹à¸”à¹‰à¸§à¸¢à¸£à¸°à¸¢à¸°à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢ XZ
					local dir = (firstEnemy.Position - hrp.Position).Unit
					hrp.CFrame = CFrame.new(firstEnemy.Position - Vector3.new(dir.X, 0, dir.Z) * teleportDistance)
				end
			end
			task.spawn(autoFarm)
		else
			if currentTween then
				currentTween:Cancel()
				currentTween = nil
			end
		end
	end,
})

DungeontTab:CreateSlider({
	Name = "Farm Speed",
	Range = {1, 10},
	Increment = 1,
	CurrentValue = farmSpeed,
	Flag = "FarmSpeed",
	Callback = function(Value)
		farmSpeed = Value
	end,
})

DungeontTab:CreateSlider({
	Name = "Teleport Distance",
	Range = {5, 20},
	Increment = 1,
	CurrentValue = teleportDistance,
	Flag = "TeleportDistance",
	Callback = function(Value)
		teleportDistance = Value
	end,
})

-- ðŸŒ¸ Auto Dungeon System (By Maple)
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local Players = game:GetService("Players")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()

-- ðŸ”¹ à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸”à¸¶à¸‡ HumanoidRootPart à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢
local function getHRP()
	local char = player.Character or player.CharacterAdded:Wait()
	return char:FindFirstChild("HumanoidRootPart")
end

local Remote = ReplicatedStorage:WaitForChild("BridgeNet2"):WaitForChild("dataRemoteEvent")

-- âœ… à¸•à¸±à¸§à¹à¸›à¸£à¸«à¸¥à¸±à¸
local AutoJoinEnabled = false
local AutoReplayEnabled = false
local joinRange = 25
local enemiesFolder = Workspace:WaitForChild("__Main"):WaitForChild("__Enemies"):WaitForChild("Server")
local CreatingDungeon = false -- à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¸‹à¹‰à¸­à¸™

-- ðŸŒ¸ à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸—à¸±à¹ˆà¸§à¹„à¸›
local function isInDungeon()
	for _, obj in ipairs(Workspace:GetDescendants()) do
		if obj:IsA("Part") and obj:FindFirstChild("Type") and obj.Type.Value == "Dungeon" then
			return true
		end
	end
	return false
end

local function isNearDungeonDoor()
	local door = Workspace:FindFirstChild("__Main")
	if door and door:FindFirstChild("__Dungeon") then
		local dungeon = door.__Dungeon:FindFirstChild("Dungeon")
		local hrp = getHRP()
		if dungeon and hrp then
			local distance = (hrp.Position - dungeon.Position).Magnitude
			return distance <= joinRange
		end
	end
	return false
end

-- ðŸŒ¸ à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸«à¸¥à¸±à¸à¸‚à¸­à¸‡à¸£à¸°à¸šà¸šà¸”à¸±à¸™à¹€à¸ˆà¸µà¹‰à¸¢à¸™
local function buyTicket()
	local args = {
		[1] = {
			[1] = {
				["Type"] = "Gems",
				["Event"] = "DungeonAction",
				["Action"] = "BuyTicket"
			},
			[2] = "\4"
		}
	}
	Remote:FireServer(unpack(args))
end

local function createDungeon()
	local args = {
		[1] = {
			[1] = {
				["Event"] = "DungeonAction",
				["Action"] = "Create"
			},
			[2] = "\4"
		}
	}
	Remote:FireServer(unpack(args))
end

local function startDungeon()
	local args = {
		[1] = {
			[1] = {
				["Event"] = "DungeonAction",
				["Action"] = "Start"
			},
			[2] = "\4"
		}
	}
	Remote:FireServer(unpack(args))
end

-- ðŸŒ¸ à¸£à¸§à¸¡à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸ªà¸£à¹‰à¸²à¸‡ + à¹€à¸£à¸´à¹ˆà¸¡à¹ƒà¸™à¸„à¸£à¸±à¹‰à¸‡à¹€à¸”à¸µà¸¢à¸§
local function safeCreateAndStartDungeon()
	if CreatingDungeon then return end
	CreatingDungeon = true

	buyTicket()
	task.wait(1)
	createDungeon()
	task.wait(2)
	startDungeon()
	task.wait(5)

	CreatingDungeon = false
end

-- ðŸŒ¸ à¸£à¸°à¸šà¸š Auto Join Dungeon
DungeontTab:CreateToggle({
	Name = "Auto Join Dungeon",
	CurrentValue = false,
	Flag = "AutoJoinDungeon",
	Callback = function(Value)
		AutoJoinEnabled = Value
		if Value then
			task.spawn(function()
				while AutoJoinEnabled do
					if not isInDungeon() and isNearDungeonDoor() then
						safeCreateAndStartDungeon()
					end
					task.wait(3)
				end
			end)
		end
	end,
})

-- ðŸŒ¸ à¸£à¸°à¸šà¸š Auto Replay (à¹€à¸£à¸´à¹ˆà¸¡à¹ƒà¸«à¸¡à¹ˆà¹€à¸¡à¸·à¹ˆà¸­à¸¡à¸­à¸™à¹„à¸¡à¹ˆà¹€à¸«à¸¥à¸·à¸­)
local function autoReplay()
	while AutoReplayEnabled do
		local enemiesAlive = false
		for _, enemy in ipairs(enemiesFolder:GetChildren()) do
			if enemy:IsA("Model") or enemy:IsA("Part") then
				enemiesAlive = true
				break
			end
		end

		if not enemiesAlive then
			task.wait(3)
			local stillNoEnemies = true
			for _, enemy in ipairs(enemiesFolder:GetChildren()) do
				if enemy:IsA("Model") or enemy:IsA("Part") then
					stillNoEnemies = false
					break
				end
			end

			if stillNoEnemies then
				safeCreateAndStartDungeon()
			end
		end

		task.wait(3)
	end
end

DungeontTab:CreateToggle({
	Name = "Auto Replay",
	CurrentValue = false,
	Flag = "AutoReplay",
	Callback = function(Value)
		AutoReplayEnabled = Value
		if Value then
			task.spawn(autoReplay)
		end
	end,
})
